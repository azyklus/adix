<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>adix/lghisto</title>
<link rel="stylesheet" type="text/css" href="../nimdoc.out.css">

<script type="text/javascript" src="../dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  if (toggleSwitch !== null) {
    toggleSwitch.addEventListener('change', switchTheme, false);
  }

  var currentTheme = localStorage.getItem('theme');
  if (!currentTheme && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    currentTheme = 'dark';
  }
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);

    if (currentTheme === 'dark' && toggleSwitch !== null) {
      toggleSwitch.checked = true;
    }
  }
}

window.addEventListener('DOMContentLoaded', main);
</script>

</head>
<body>
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">adix/lghisto</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple">
    <li>
      <a href="../theindex.html">Index</a>
    </li>
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  <div>
    Group by:
    <select onchange="groupBy(this.value)">
      <option value="section">Section</option>
      <option value="type">Type</option>
    </select>
  </div>
  <ul class="simple simple-toc" id="toc-list">
<li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#LgHisto"
    title="LgHisto[C] = object
  n: int
  a, b: float
  aLn, h, hInv: float
  bist: Bist[C]">LgHisto</a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">$
      <li><a class="reference" href="#%24%2CLgHisto%5BC%5D"
    title="`$`[C](s: LgHisto[C]; nonZero = true): string">`$`[C](s: LgHisto[C]; nonZero = true): string</a></li>

  </ul>
  <ul class="simple nested-toc-section">add
      <li><a class="reference" href="#add%2CLgHisto%5BC%5D%2CF%2Ctypeof%281.C%29"
    title="add[F, C](s: var LgHisto[C]; x: F; w = 1.C)">add[F, C](s: var LgHisto[C]; x: F; w = 1.C)</a></li>

  </ul>
  <ul class="simple nested-toc-section">binAB
      <li><a class="reference" href="#binAB%2CLgHisto%5BC%5D%2CF"
    title="binAB[F, C](s: LgHisto[C]; x: F): (float, float)">binAB[F, C](s: LgHisto[C]; x: F): (float, float)</a></li>

  </ul>
  <ul class="simple nested-toc-section">bist
      <li><a class="reference" href="#bist%2CLgHisto%5BC%5D"
    title="bist[C](s: LgHisto[C]): Bist[C]">bist[C](s: LgHisto[C]): Bist[C]</a></li>

  </ul>
  <ul class="simple nested-toc-section">cdf
      <li><a class="reference" href="#cdf%2CLgHisto%5BC%5D%2CF"
    title="cdf[F, C](s: LgHisto[C]; x: F): C">cdf[F, C](s: LgHisto[C]; x: F): C</a></li>

  </ul>
  <ul class="simple nested-toc-section">fromIx
      <li><a class="reference" href="#fromIx%2CLgHisto%5BC%5D%2Cint%2CF"
    title="fromIx[F, C](s: LgHisto[C]; i: int; offset: F = 0.5): F">fromIx[F, C](s: LgHisto[C]; i: int; offset: F = 0.5): F</a></li>

  </ul>
  <ul class="simple nested-toc-section">high
      <li><a class="reference" href="#high%2CLgHisto%5BC%5D"
    title="high[C](s: LgHisto[C]): float">high[C](s: LgHisto[C]): float</a></li>

  </ul>
  <ul class="simple nested-toc-section">init
      <li><a class="reference" href="#init%2CLgHisto%5BC%5D%2Cfloat%2Cfloat%2Cint"
    title="init[C](s: var LgHisto[C]; a = 1e-16; b = 1e+20; n = 8300)">init[C](s: var LgHisto[C]; a = 1e-16; b = 1e+20; n = 8300)</a></li>

  </ul>
  <ul class="simple nested-toc-section">initLgHisto
      <li><a class="reference" href="#initLgHisto%2Cfloat%2Cfloat%2Cint"
    title="initLgHisto[C](a = 1e-16; b = 1e+20; n = 8300): LgHisto[C]">initLgHisto[C](a = 1e-16; b = 1e+20; n = 8300): LgHisto[C]</a></li>

  </ul>
  <ul class="simple nested-toc-section">low
      <li><a class="reference" href="#low%2CLgHisto%5BC%5D"
    title="low[C](s: LgHisto[C]): float">low[C](s: LgHisto[C]): float</a></li>

  </ul>
  <ul class="simple nested-toc-section">merge
      <li><a class="reference" href="#merge%2CLgHisto%5BC%5D%2CLgHisto%5BC%5D"
    title="merge[C](dst: var LgHisto[C]; src: LgHisto[C])">merge[C](dst: var LgHisto[C]; src: LgHisto[C])</a></li>

  </ul>
  <ul class="simple nested-toc-section">nBin
      <li><a class="reference" href="#nBin%2CLgHisto%5BC%5D"
    title="nBin[C](s: LgHisto[C]): int">nBin[C](s: LgHisto[C]): int</a></li>

  </ul>
  <ul class="simple nested-toc-section">overflows
      <li><a class="reference" href="#overflows%2CLgHisto%5BC%5D"
    title="overflows[C](s: LgHisto[C]): int">overflows[C](s: LgHisto[C]): int</a></li>

  </ul>
  <ul class="simple nested-toc-section">pop
      <li><a class="reference" href="#pop%2CLgHisto%5BC%5D%2CF%2Ctypeof%281.C%29"
    title="pop[F, C](s: var LgHisto[C]; x: F; w = 1.C)">pop[F, C](s: var LgHisto[C]; x: F; w = 1.C)</a></li>

  </ul>
  <ul class="simple nested-toc-section">quantile
      <li><a class="reference" href="#quantile%2CLgHisto%5BC%5D%2CF"
    title="quantile[F, C](s: LgHisto[C]; q: F): F">quantile[F, C](s: LgHisto[C]; q: F): F</a></li>

  </ul>
  <ul class="simple nested-toc-section">space
      <li><a class="reference" href="#space%2CLgHisto%5BC%5D"
    title="space[C](s: LgHisto[C]): int">space[C](s: LgHisto[C]): int</a></li>

  </ul>
  <ul class="simple nested-toc-section">toIx
      <li><a class="reference" href="#toIx%2CLgHisto%5BC%5D%2CF"
    title="toIx[F, C](s: LgHisto[C]; x: F): int">toIx[F, C](s: LgHisto[C]; x: F): int</a></li>

  </ul>
  <ul class="simple nested-toc-section">underflows
      <li><a class="reference" href="#underflows%2CLgHisto%5BC%5D"
    title="underflows[C](s: LgHisto[C]): int">underflows[C](s: LgHisto[C]): int</a></li>

  </ul>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#15" id="65">Iterators</a>
  <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">bins
      <li><a class="reference" href="#bins.i%2CLgHisto%5BC%5D"
    title="bins[C](s: LgHisto[C]): (float, float, C)">bins[C](s: LgHisto[C]): (float, float, C)</a></li>

  </ul>

  </ul>
</li>

</ul>

  </div>
  &nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L1"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L1" class="link-seesrc" target="_blank" >Edit</a>

  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc"><p><tt class="docutils literal"><span class="pre"><span class="Identifier">LgHisto</span></span></tt> is a simple application of BISTs to log-spaced histograms that can yield efficient, dynamic quantiles.  log-spacing supports high dynamic range without inordinate cost while Fenwick/BIST supports dynamic membership with operation-balanced perf.</p>
<p>Quantile error is absolute {not relative to <tt class="docutils literal"><span class="pre"><span class="Identifier">q</span><span class="Operator">*</span><span class="Punctuation">(</span><span class="DecNumber">1</span><span class="Operator">-</span><span class="Identifier">q</span><span class="Punctuation">)</span></span></tt> like a t-Digest} &amp; easily bounded as &lt;~ 1/2 bin width {about 10^(lg(b/a)/n/2)}.  So, if you need 3 places or your data is clustered within a few orders of magnitude then you can likely just use 1e4 bins and your counters will remain very L1 cache resident, depending upon resource competition.  Cache is the main cost Re: speed.  Re: space, since 99% of bins are 0 in many cases, net/disk transfer cost can be improved via simple run-length encoding.</p>
<p>The way Fenwick BISTs work, the generic parameter <tt class="docutils literal"><span class="pre"><span class="Identifier">C</span></span></tt> must be a wide enough integer type to hold both elemental bin counts AND grand totals.  uint32 is likely enough for many applications, though some might sneak by with uint16 and a few might need uint64.  This scales bin size/space cost.</p>
<p>t-Digests are a well marketed competitor using ~10X less space BUT with &gt;&gt;5X slower quantiles of similar accuracy.  Actual cost is sensitive to operation mixes. { This may change, but present t-Digest impls, even with trees, linear scan for quantile/CDFs.  None even offer &quot;batch&quot; APIs to do N quantiles in one such scan.  &quot;Histo B-trees&quot; should allow better scaling for such. }  A BIST basis differs from t-Digests in other important ways.  First, BISTs are well suited for <tt class="docutils literal"><span class="pre"><span class="Identifier">pop</span></span></tt> or moving data window operations with <em>strict</em> finite memory, for e.g. translation of full streams to moving quantiles as in Bollinger Band style smooths.  Second, floating point weights for EWMA-like decaying memory are not possible since FP arithmetic kind of breaks BISTs.</p>
</p>
  <div class="section" id="6">
<h1><a class="toc-backref" href="#6">Imports</a></h1>
<dl class="item">
<a class="reference external" href="bist.html">bist</a>
</dl></div>
<div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<div id="LgHisto">
<dt><pre><a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">n</span><span class="Other">:</span> <span class="Identifier">int</span>
  <span class="Identifier">a</span><span class="Other">,</span> <span class="Identifier">b</span><span class="Other">:</span> <span class="Identifier">float</span>
  <span class="Identifier">aLn</span><span class="Other">,</span> <span class="Identifier">h</span><span class="Other">,</span> <span class="Identifier">hInv</span><span class="Other">:</span> <span class="Identifier">float</span>
  <span class="Identifier">bist</span><span class="Other">:</span> <a href="bist.html#Bist"><span class="Identifier">Bist</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span>
</pre></dt>
<dd>

Log-spaced histogram with <tt class="docutils literal"><span class="pre"><span class="Identifier">Bist</span><span class="Punctuation">[</span><span class="Identifier">C</span><span class="Punctuation">]</span></span></tt> backing
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L33"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L33" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<div id="$,LgHisto[C]">
<dt><pre><span class="Keyword">proc</span> <a href="#%24%2CLgHisto%5BC%5D"><span class="Identifier">`$`</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">nonZero</span> <span class="Other">=</span> <span class="Identifier">true</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
<dd>

Formatting operator; Warning: output can be large, esp. if nonZero=false
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L112"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L112" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="add,LgHisto[C],F,typeof(1.C)">
<dt><pre><span class="Keyword">func</span> <a href="#add%2CLgHisto%5BC%5D%2CF%2Ctypeof%281.C%29"><span class="Identifier">add</span></a><span class="Other">[</span><span class="Identifier">F</span><span class="Other">,</span> <span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">F</span><span class="Other">;</span> <span class="Identifier">w</span> <span class="Other">=</span> <span class="DecNumber">1</span><span class="Other">.</span><span class="Identifier">C</span><span class="Other">)</span></pre></dt>
<dd>

Increment bin for value <tt class="docutils literal"><span class="pre"><span class="Identifier">x</span></span></tt> by weight <tt class="docutils literal"><span class="pre"><span class="Identifier">w</span></span></tt>
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L94"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L94" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="binAB,LgHisto[C],F">
<dt><pre><span class="Keyword">func</span> <a href="#binAB%2CLgHisto%5BC%5D%2CF"><span class="Identifier">binAB</span></a><span class="Other">[</span><span class="Identifier">F</span><span class="Other">,</span> <span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">F</span><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">float</span><span class="Other">,</span> <span class="Identifier">float</span><span class="Other">)</span></pre></dt>
<dd>

Range in data space of the bin containing <tt class="docutils literal"><span class="pre"><span class="Identifier">x</span></span></tt>; Costs 2 <tt class="docutils literal"><span class="pre"><span class="Identifier">fromIx</span></span></tt>s.
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L83"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L83" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="bist,LgHisto[C]">
<dt><pre><span class="Keyword">func</span> <a href="#bist%2CLgHisto%5BC%5D"><span class="Identifier">bist</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <a href="bist.html#Bist"><span class="Identifier">Bist</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L46"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L46" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="cdf,LgHisto[C],F">
<dt><pre><span class="Keyword">func</span> <a href="#cdf%2CLgHisto%5BC%5D%2CF"><span class="Identifier">cdf</span></a><span class="Other">[</span><span class="Identifier">F</span><span class="Other">,</span> <span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">F</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">C</span></pre></dt>
<dd>

Raw count; Leave to caller to multiply by 1/s.bist.count; XXX Interpolate?
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L133"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L133" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="fromIx,LgHisto[C],int,F">
<dt><pre><span class="Keyword">func</span> <a href="#fromIx%2CLgHisto%5BC%5D%2Cint%2CF"><span class="Identifier">fromIx</span></a><span class="Other">[</span><span class="Identifier">F</span><span class="Other">,</span> <span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">i</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">offset</span><span class="Other">:</span> <span class="Identifier">F</span> <span class="Other">=</span> <span class="FloatNumber">0.5</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">F</span></pre></dt>
<dd>

Geometric mean of left&amp;right edge log-shifted <tt class="docutils literal"><span class="pre"><span class="Identifier">offset</span></span></tt> fraction into bin
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L77"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L77" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="high,LgHisto[C]">
<dt><pre><span class="Keyword">func</span> <a href="#high%2CLgHisto%5BC%5D"><span class="Identifier">high</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">float</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L44"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L44" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="init,LgHisto[C],float,float,int">
<dt><pre><span class="Keyword">func</span> <a href="#init%2CLgHisto%5BC%5D%2Cfloat%2Cfloat%2Cint"><span class="Identifier">init</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">a</span> <span class="Other">=</span> <span class="FloatNumber">1e-16</span><span class="Other">;</span> <span class="Identifier">b</span> <span class="Other">=</span> <span class="FloatNumber">1e+20</span><span class="Other">;</span> <span class="Identifier">n</span> <span class="Other">=</span> <span class="DecNumber">8300</span><span class="Other">)</span></pre></dt>
<dd>

Init histo w/2n+1 log-spaced bins: <tt class="docutils literal"><span class="pre"><span class="Punctuation">[</span><span class="Operator">-</span><span class="Identifier">∞</span><span class="Operator">..-</span><span class="Identifier">b</span><span class="Punctuation">;</span> <span class="Operator">-</span><span class="Identifier">b</span><span class="Operator">..-</span><span class="Identifier">a</span><span class="Punctuation">;</span> <span class="DecNumber">0</span><span class="Punctuation">;</span> <span class="Identifier">a</span><span class="Operator">..&lt;</span><span class="Identifier">b</span><span class="Punctuation">;</span> <span class="Identifier">b</span><span class="Operator">..</span><span class="Identifier">∞</span><span class="Punctuation">]</span></span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L48"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L48" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="initLgHisto,float,float,int">
<dt><pre><span class="Keyword">func</span> <a href="#initLgHisto%2Cfloat%2Cfloat%2Cint"><span class="Identifier">initLgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">a</span> <span class="Other">=</span> <span class="FloatNumber">1e-16</span><span class="Other">;</span> <span class="Identifier">b</span> <span class="Other">=</span> <span class="FloatNumber">1e+20</span><span class="Other">;</span> <span class="Identifier">n</span> <span class="Other">=</span> <span class="DecNumber">8300</span><span class="Other">)</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span></pre></dt>
<dd>

Get Histo w/2n+1 log-spaced bins: <tt class="docutils literal"><span class="pre"><span class="Punctuation">[</span><span class="Operator">-</span><span class="Identifier">inf</span><span class="Operator">..&lt;-</span><span class="Identifier">b</span><span class="Punctuation">;</span> <span class="Operator">-</span><span class="Identifier">b</span><span class="Operator">..&lt;-</span><span class="Identifier">a</span><span class="Punctuation">;</span> <span class="DecNumber">0</span><span class="Punctuation">;</span> <span class="Identifier">a</span><span class="Operator">..&lt;</span><span class="Identifier">b</span><span class="Punctuation">;</span> <span class="Identifier">b</span><span class="Operator">..</span><span class="Identifier">inf</span><span class="Punctuation">]</span></span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L61"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L61" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="low,LgHisto[C]">
<dt><pre><span class="Keyword">func</span> <a href="#low%2CLgHisto%5BC%5D"><span class="Identifier">low</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">float</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L43"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L43" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="merge,LgHisto[C],LgHisto[C]">
<dt><pre><span class="Keyword">func</span> <a href="#merge%2CLgHisto%5BC%5D%2CLgHisto%5BC%5D"><span class="Identifier">merge</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">dst</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">src</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
<dd>

Merge counts from src into dst.
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L137"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L137" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="nBin,LgHisto[C]">
<dt><pre><span class="Keyword">func</span> <a href="#nBin%2CLgHisto%5BC%5D"><span class="Identifier">nBin</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L45"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L45" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="overflows,LgHisto[C]">
<dt><pre><span class="Keyword">func</span> <a href="#overflows%2CLgHisto%5BC%5D"><span class="Identifier">overflows</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L42"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L42" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="pop,LgHisto[C],F,typeof(1.C)">
<dt><pre><span class="Keyword">func</span> <a href="#pop%2CLgHisto%5BC%5D%2CF%2Ctypeof%281.C%29"><span class="Identifier">pop</span></a><span class="Other">[</span><span class="Identifier">F</span><span class="Other">,</span> <span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">F</span><span class="Other">;</span> <span class="Identifier">w</span> <span class="Other">=</span> <span class="DecNumber">1</span><span class="Other">.</span><span class="Identifier">C</span><span class="Other">)</span></pre></dt>
<dd>

Alias for <tt class="docutils literal"><span class="pre"><span class="Identifier">add</span></span></tt> with a negative weight argument
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L98"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L98" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="quantile,LgHisto[C],F">
<dt><pre><span class="Keyword">func</span> <a href="#quantile%2CLgHisto%5BC%5D%2CF"><span class="Identifier">quantile</span></a><span class="Other">[</span><span class="Identifier">F</span><span class="Other">,</span> <span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">q</span><span class="Other">:</span> <span class="Identifier">F</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">F</span></pre></dt>
<dd>

Basic quantile; XXX Can log-spacing savvy interpolation be more accurate?
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L126"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L126" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="space,LgHisto[C]">
<dt><pre><span class="Keyword">func</span> <a href="#space%2CLgHisto%5BC%5D"><span class="Identifier">space</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
<dd>

Estimate space taken up by data structure in bytes
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L64"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L64" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="toIx,LgHisto[C],F">
<dt><pre><span class="Keyword">func</span> <a href="#toIx%2CLgHisto%5BC%5D%2CF"><span class="Identifier">toIx</span></a><span class="Other">[</span><span class="Identifier">F</span><span class="Other">,</span> <span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">F</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
<dd>

Find bin index for value <tt class="docutils literal"><span class="pre"><span class="Identifier">x</span></span></tt>; underflows get <tt class="docutils literal"><span class="pre"><span class="Punctuation">[</span><span class="DecNumber">0</span><span class="Punctuation">]</span></span></tt> &amp; overflows get <tt class="docutils literal"><span class="pre"><span class="Punctuation">[</span><span class="DecNumber">2</span><span class="Operator">*</span><span class="Identifier">n</span><span class="Punctuation">]</span></span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L67"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L67" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="underflows,LgHisto[C]">
<dt><pre><span class="Keyword">func</span> <a href="#underflows%2CLgHisto%5BC%5D"><span class="Identifier">underflows</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L41"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L41" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>

</dl></div>
<div class="section" id="15">
<h1><a class="toc-backref" href="#15">Iterators</a></h1>
<dl class="item">
<div id="bins.i,LgHisto[C]">
<dt><pre><span class="Keyword">iterator</span> <a href="#bins.i%2CLgHisto%5BC%5D"><span class="Identifier">bins</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <a href="lghisto.html#LgHisto"><span class="Identifier">LgHisto</span></a><span class="Other">[</span><span class="Identifier">C</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">float</span><span class="Other">,</span> <span class="Identifier">float</span><span class="Other">,</span> <span class="Identifier">C</span><span class="Other">)</span></pre></dt>
<dd>

Yield <tt class="docutils literal"><span class="pre"><span class="Punctuation">(</span><span class="Identifier">lo</span><span class="Punctuation">,</span> <span class="Identifier">hi</span><span class="Punctuation">,</span> <span class="Identifier">count</span><span class="Punctuation">)</span></span></tt> for each bin covered
&nbsp;&nbsp;<a
href="https://github.com/c-blake/adix/tree/f3da56d0f13bb4e29ddfe94583e10a216d26656a/adix/lghisto.nim#L102"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/c-blake/adix/edit/master/adix/lghisto.nim#L102" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2023-03-18 14:31:07 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
